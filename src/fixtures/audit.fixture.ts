import type { AuditEvent } from '@/modules/admin/audit/mockAuditEvents'
import { AUDIT_REFERENCE_TIMESTAMP } from '@/modules/admin/audit/mockAuditEvents'
import { SystemRole } from '@/modules/shared/types/auth'

const hoursAgo = (hours: number) => new Date(AUDIT_REFERENCE_TIMESTAMP - hours * 60 * 60 * 1000).toISOString()
const minutesAgo = (minutes: number) => new Date(AUDIT_REFERENCE_TIMESTAMP - minutes * 60 * 1000).toISOString()

export const mockAuditEvents: AuditEvent[] = [
  {
    id: 'AUD-2025-0048',
    timestamp: minutesAgo(15),
    actorName: 'Lara Monteiro',
    actorEmail: 'lara.monteiro@unifique.com',
    actorRole: SystemRole.ADMIN_MASTER,
    tenantId: 'tenant-smartmall',
    tenantName: 'Smart Mall Florianópolis',
    actionType: 'ALERT_RULE_CHANGED',
    severity: 'high',
    description: 'Ajustou limite de latência da regra "Cluster lotado".',
    origin: 'WEB',
    ipAddress: '2804:14d:149:4200::25',
    userAgent: 'Chrome 121 / macOS',
    resourceType: 'ALERT_RULE',
    resourceId: 'alert-crowd-01',
    resourceName: 'Crowd Density South',
    diffSummary: 'latencyThreshold: 1200ms → 850ms'
  },
  {
    id: 'AUD-2025-0047',
    timestamp: minutesAgo(28),
    actorName: 'Diego Pacheco',
    actorEmail: 'diego.pacheco@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'LOGIN',
    severity: 'low',
    description: 'Login realizado via SSO corporativo.',
    origin: 'WEB',
    ipAddress: '187.36.22.18',
    userAgent: 'Edge 120 / Windows'
  },
  {
    id: 'AUD-2025-0046',
    timestamp: minutesAgo(42),
    actorName: 'Joana Furtado',
    actorEmail: 'joana.furtado@parceiro.ai',
    actorRole: SystemRole.TECHNICIAN,
    tenantId: 'tenant-techpark',
    tenantName: 'Tech Park Joinville',
    actionType: 'ACCESS_TEMP_GRANTED',
    severity: 'medium',
    description: 'Concessão de acesso emergencial para manutenção das câmeras.',
    origin: 'WEB',
    resourceType: 'CAMERA',
    resourceId: 'cam-techpark-lobby',
    resourceName: 'Lobby Entrada 01',
    diffSummary: 'jan/10 10:00 → jan/11 10:00'
  },
  {
    id: 'AUD-2025-0045',
    timestamp: minutesAgo(55),
    actorName: 'Helena Freitas',
    actorEmail: 'helena.freitas@unifique.com',
    actorRole: SystemRole.ADMIN_MASTER,
    actionType: 'INFRA_SERVER_UPDATED',
    severity: 'critical',
    description: 'Atualizou limite de GPU do cluster IA Litoral.',
    origin: 'WEB',
    resourceType: 'INFRA',
    resourceId: 'gpu-cluster-litoral',
    resourceName: 'Cluster IA Litoral',
    diffSummary: 'gpuReservation: 70% → 82%'
  },
  {
    id: 'AUD-2025-0044',
    timestamp: hoursAgo(2),
    actorName: 'Sistema VMS',
    actorEmail: 'system@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'ACCESS_TEMP_REVOKED',
    severity: 'medium',
    description: 'Revogação automática por expiração do acesso temporário do técnico.',
    origin: 'SYSTEM',
    tenantId: 'tenant-techpark',
    tenantName: 'Tech Park Joinville',
    resourceType: 'CAMERA',
    resourceId: 'cam-techpark-lobby',
    resourceName: 'Lobby Entrada 01'
  },
  {
    id: 'AUD-2025-0043',
    timestamp: hoursAgo(2.5),
    actorName: 'Marcos Bellini',
    actorEmail: 'marcos.bellini@unifique.com',
    actorRole: SystemRole.ADMIN,
    tenantId: 'tenant-smartmall',
    tenantName: 'Smart Mall Florianópolis',
    actionType: 'CAMERA_CONFIG_CHANGED',
    severity: 'medium',
    description: 'Ativou trilha de metadados para câmeras térmicas.',
    origin: 'WEB',
    resourceType: 'CAMERA',
    resourceId: 'cam-smartmall-rooftop',
    resourceName: 'Rooftop Oeste',
    diffSummary: 'metadados térmicos: inativo → ativo'
  },
  {
    id: 'AUD-2025-0042',
    timestamp: hoursAgo(3),
    actorName: 'Bruno S. Alves',
    actorEmail: 'bruno.alves@alphacase.com',
    actorRole: SystemRole.CLIENT_MASTER,
    tenantId: 'tenant-alphacase',
    tenantName: 'Alpha Case Data Center',
    actionType: 'TENANT_UPDATED',
    severity: 'low',
    description: 'Atualizou contato principal do tenant.',
    origin: 'WEB',
    resourceType: 'TENANT',
    resourceId: 'tenant-alphacase',
    resourceName: 'Alpha Case Data Center'
  },
  {
    id: 'AUD-2025-0041',
    timestamp: hoursAgo(3.2),
    actorName: 'Equipe DevOps',
    actorEmail: 'devops@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'INFRA_SERVER_ADDED',
    severity: 'high',
    description: 'Provisionou nó de gravação NVMe cluster oeste.',
    origin: 'SCRIPT',
    resourceType: 'INFRA',
    resourceId: 'rec-node-west-07',
    resourceName: 'Recorder West 07'
  },
  {
    id: 'AUD-2025-0040',
    timestamp: hoursAgo(3.5),
    actorName: 'Lara Monteiro',
    actorEmail: 'lara.monteiro@unifique.com',
    actorRole: SystemRole.ADMIN_MASTER,
    actionType: 'USER_ROLE_CHANGED',
    severity: 'medium',
    description: 'Elevou permissões do gestor regional.',
    origin: 'WEB',
    resourceType: 'USER',
    resourceId: 'usr-claudio-ramos',
    resourceName: 'Cláudio Ramos',
    diffSummary: 'CLIENT_MANAGER → CLIENT_MASTER'
  },
  {
    id: 'AUD-2025-0039',
    timestamp: hoursAgo(4),
    actorName: 'Cláudio Ramos',
    actorEmail: 'claudio.ramos@varejonorte.com',
    actorRole: SystemRole.CLIENT_MASTER,
    actionType: 'LOGIN',
    severity: 'low',
    description: 'Login aprovado (MFA).',
    origin: 'WEB',
    tenantId: 'tenant-varejo-norte',
    tenantName: 'Varejo Norte',
    ipAddress: '170.80.22.11',
    userAgent: 'Safari iOS 18'
  },
  {
    id: 'AUD-2025-0038',
    timestamp: hoursAgo(4.2),
    actorName: 'Cláudio Ramos',
    actorEmail: 'claudio.ramos@varejonorte.com',
    actorRole: SystemRole.CLIENT_MASTER,
    actionType: 'CAMERA_CREATED',
    severity: 'medium',
    description: 'Cadastrou câmera de self-checkout 05.',
    origin: 'WEB',
    tenantId: 'tenant-varejo-norte',
    tenantName: 'Varejo Norte',
    resourceType: 'CAMERA',
    resourceId: 'cam-vn-sco-05',
    resourceName: 'Self Checkout 05'
  },
  {
    id: 'AUD-2025-0037',
    timestamp: hoursAgo(4.8),
    actorName: 'Equipe AI OPS',
    actorEmail: 'ai.ops@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'IA_CONFIG_CHANGED',
    severity: 'high',
    description: 'Reconfigurou pipeline de detecção de intrusão para condomínios.',
    origin: 'SCRIPT',
    tenantId: 'tenant-condominio-sul',
    tenantName: 'Condomínio Sul Atlântico',
    resourceType: 'IA',
    resourceId: 'ia-intrusion-02',
    resourceName: 'Intrusão Cond. Sul',
    diffSummary: 'sensibilidade: 0.72 → 0.81'
  },
  {
    id: 'AUD-2025-0036',
    timestamp: hoursAgo(5.2),
    actorName: 'Sistema VMS',
    actorEmail: 'system@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'LOGOUT',
    severity: 'low',
    description: 'Sessão expirada automaticamente.',
    origin: 'SYSTEM',
    tenantId: 'tenant-smartmall',
    tenantName: 'Smart Mall Florianópolis'
  },
  {
    id: 'AUD-2025-0035',
    timestamp: hoursAgo(5.5),
    actorName: 'Cláudia Medeiros',
    actorEmail: 'claudia.medeiros@unifique.com',
    actorRole: SystemRole.ADMIN_MASTER,
    actionType: 'TENANT_CREATED',
    severity: 'high',
    description: 'Onboarding do cliente Aeroparque Porto Alegre.',
    origin: 'WEB',
    resourceType: 'TENANT',
    resourceId: 'tenant-aeroparque',
    resourceName: 'Aeroparque Porto Alegre'
  },
  {
    id: 'AUD-2025-0034',
    timestamp: hoursAgo(6),
    actorName: 'Rafael Koch',
    actorEmail: 'rafael.koch@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'ALERT_RULE_CHANGED',
    severity: 'medium',
    description: 'Alterou janela de silêncio para alertas de fumaça IA.',
    origin: 'WEB',
    resourceType: 'ALERT_RULE',
    resourceId: 'alert-smoke-03',
    resourceName: 'IA Fumaça - Galpões',
    diffSummary: 'cooldown: 15 min → 8 min'
  },
  {
    id: 'AUD-2025-0033',
    timestamp: hoursAgo(6.5),
    actorName: 'Equipe DevOps',
    actorEmail: 'devops@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'INFRA_SERVER_REMOVED',
    severity: 'high',
    description: 'Descomissionou servidor legado DVR-04.',
    origin: 'SCRIPT',
    resourceType: 'INFRA',
    resourceId: 'dvr-04',
    resourceName: 'Recorder Legacy 04',
    diffSummary: 'status: active → retired'
  },
  {
    id: 'AUD-2025-0032',
    timestamp: hoursAgo(7),
    actorName: 'Lara Monteiro',
    actorEmail: 'lara.monteiro@unifique.com',
    actorRole: SystemRole.ADMIN_MASTER,
    actionType: 'USER_CREATED',
    severity: 'medium',
    description: 'Novo admin regional cadastrado.',
    origin: 'WEB',
    resourceType: 'USER',
    resourceId: 'usr-nadia-silva',
    resourceName: 'Nádia Silva'
  },
  {
    id: 'AUD-2025-0031',
    timestamp: hoursAgo(7.5),
    actorName: 'Nádia Silva',
    actorEmail: 'nadia.silva@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'LOGIN',
    severity: 'low',
    description: 'Primeiro login após convite.',
    origin: 'WEB',
    ipAddress: '168.194.24.55',
    userAgent: 'Firefox 120 / Linux'
  },
  {
    id: 'AUD-2025-0030',
    timestamp: hoursAgo(8),
    actorName: 'Marcelo Prado',
    actorEmail: 'marcelo.prado@unifique.com',
    actorRole: SystemRole.ADMIN,
    tenantId: 'tenant-aquarius',
    tenantName: 'Residencial Aquarius',
    actionType: 'CAMERA_CONFIG_CHANGED',
    severity: 'medium',
    description: 'Atualizou máscara de privacidade do bloco B.',
    origin: 'WEB',
    resourceType: 'CAMERA',
    resourceId: 'cam-aqua-b2',
    resourceName: 'Bloco B - Acesso'
  },
  {
    id: 'AUD-2025-0029',
    timestamp: hoursAgo(8.3),
    actorName: 'Plataforma VMS',
    actorEmail: 'system@unifique.com',
    actorRole: SystemRole.ADMIN,
    tenantId: 'tenant-aquarius',
    tenantName: 'Residencial Aquarius',
    actionType: 'IA_CONFIG_CHANGED',
    severity: 'high',
    description: 'Rollback automático de modelo IA por drift.',
    origin: 'SYSTEM',
    resourceType: 'IA',
    resourceId: 'ia-drift-rollback-01',
    resourceName: 'Detector de placas - Aquarius',
    diffSummary: 'modelo v4.3 → v4.2 (estável)'
  },
  {
    id: 'AUD-2025-0028',
    timestamp: hoursAgo(8.8),
    actorName: 'Joana Furtado',
    actorEmail: 'joana.furtado@parceiro.ai',
    actorRole: SystemRole.TECHNICIAN,
    actionType: 'ACCESS_TEMP_GRANTED',
    severity: 'medium',
    description: 'Solicitou extensão do acesso técnico (aprovado).',
    origin: 'WEB',
    tenantId: 'tenant-techpark',
    tenantName: 'Tech Park Joinville',
    resourceType: 'TENANT',
    resourceId: 'tenant-techpark',
    resourceName: 'Tech Park Joinville',
    diffSummary: 'vigência +48h'
  },
  {
    id: 'AUD-2025-0027',
    timestamp: hoursAgo(9.5),
    actorName: 'Helena Freitas',
    actorEmail: 'helena.freitas@unifique.com',
    actorRole: SystemRole.ADMIN_MASTER,
    actionType: 'INFRA_SERVER_ADDED',
    severity: 'high',
    description: 'Provisionou nó GPU para cluster IA metropolitano.',
    origin: 'WEB',
    resourceType: 'INFRA',
    resourceId: 'gpu-cluster-metro',
    resourceName: 'Cluster IA Metropolitano'
  },
  {
    id: 'AUD-2025-0026',
    timestamp: hoursAgo(10),
    actorName: 'Eduardo Farias',
    actorEmail: 'eduardo.farias@unifique.com.br',
    actorRole: SystemRole.ADMIN,
    tenantId: 'tenant-unifique-hq',
    tenantName: 'Unifique Headquarters',
    actionType: 'CAMERA_CREATED',
    severity: 'medium',
    description: 'Habilitou câmera reserva no NOC.',
    origin: 'WEB',
    resourceType: 'CAMERA',
    resourceId: 'cam-noc-reserva-01',
    resourceName: 'NOC Reserva 01'
  },
  {
    id: 'AUD-2025-0025',
    timestamp: hoursAgo(10.5),
    actorName: 'Letícia Gomes',
    actorEmail: 'leticia.gomes@unifique.com',
    actorRole: SystemRole.CLIENT_MASTER,
    tenantId: 'tenant-unifique-hq',
    tenantName: 'Unifique Headquarters',
    actionType: 'USER_CREATED',
    severity: 'medium',
    description: 'Convidou gestora regional para acesso parcial.',
    origin: 'WEB',
    resourceType: 'USER',
    resourceId: 'usr-marina-campos',
    resourceName: 'Marina Campos'
  },
  {
    id: 'AUD-2025-0024',
    timestamp: hoursAgo(11.2),
    actorName: 'Operação Retail Park',
    actorEmail: 'operacao@retailpark.com',
    actorRole: SystemRole.TECHNICIAN,
    tenantId: 'tenant-retail-park',
    tenantName: 'Retail Park Brasil',
    actionType: 'ACCESS_TEMP_REVOKED',
    severity: 'medium',
    description: 'Encerramento manual de acesso técnico após manutenção.',
    origin: 'WEB',
    resourceType: 'CAMERA',
    resourceId: 'cam-retail-doca-04',
    resourceName: 'Doca 04'
  },
  {
    id: 'AUD-2025-0023',
    timestamp: hoursAgo(11.5),
    actorName: 'Rafael Dias',
    actorEmail: 'rafael.dias@retailpark.com',
    actorRole: SystemRole.CLIENT_MASTER,
    tenantId: 'tenant-retail-park',
    tenantName: 'Retail Park Brasil',
    actionType: 'ALERT_RULE_CHANGED',
    severity: 'medium',
    description: 'Reduziu severidade de fila de veículos no centro sul.',
    origin: 'WEB',
    resourceType: 'ALERT_RULE',
    resourceId: 'alert-queue-01',
    resourceName: 'Fila Docas Sul',
    diffSummary: 'critical → high'
  },
  {
    id: 'AUD-2025-0022',
    timestamp: hoursAgo(12),
    actorName: 'Sistema VMS',
    actorEmail: 'system@unifique.com',
    actorRole: SystemRole.ADMIN,
    actionType: 'INFRA_SERVER_UPDATED',
    severity: 'high',
    description: 'Auto scaling disparado no cluster oeste.',
    origin: 'SYSTEM',
    resourceType: 'INFRA',
    resourceId: 'rec-node-west-05',
    resourceName: 'Recorder West 05',
    diffSummary: 'replicas: 8 → 12'
  }
]
